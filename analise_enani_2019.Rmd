---
title: 'An√°lise Explorat√≥ria do ENANI 2019: Padr√µes Alimentares e Nutricionais Infantis
  no Brasil'
author: "Steffano Pereira"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: cosmo
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    code_folding: show
    df_print: paged
  pdf_document:
    toc: true
    toc_depth: '3'
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 10,
  fig.height = 6,
  dpi = 300
)
```

# Introdu√ß√£o {.tabset}

## Declara√ß√£o do Problema

A alimenta√ß√£o infantil adequada √© fundamental para o desenvolvimento f√≠sico e cognitivo das crian√ßas brasileiras. No Brasil, existem grandes disparidades regionais e socioecon√¥micas que afetam diretamente a qualidade da alimenta√ß√£o e o estado nutricional infantil. Compreender os padr√µes alimentares das crian√ßas brasileiras, especialmente nos primeiros anos de vida, √© crucial para:

- **Identificar grupos em risco nutricional**
- **Avaliar pr√°ticas de aleitamento materno**
- **Detectar consumo excessivo de alimentos ultraprocessados**
- **Orientar pol√≠ticas p√∫blicas de sa√∫de infantil**

Este projeto √© relevante porque oferece insights baseados em dados para melhorar a sa√∫de p√∫blica infantil no Brasil.

## Abordagem Metodol√≥gica

Este projeto utilizar√° o **ENANI 2019** (Estudo Nacional de Alimenta√ß√£o e Nutri√ß√£o Infantil) [@enani2019], um conjunto de dados representativo nacional que cont√©m informa√ß√µes detalhadas sobre:

- Caracter√≠sticas demogr√°ficas e socioecon√¥micas
- Padr√µes de alimenta√ß√£o e consumo alimentar
- Dados antropom√©tricos (peso, altura)
- Informa√ß√µes de sa√∫de materna e infantil

A metodologia empregada inclui:

1. **Importa√ß√£o e limpeza dos dados** brutos do CSV
2. **Tratamento de valores ausentes** (NAs)
3. **Sele√ß√£o de vari√°veis relevantes** para an√°lise nutricional
4. **Cria√ß√£o de novas vari√°veis** (√≠ndices nutricionais, categorias)
5. **An√°lise explorat√≥ria** atrav√©s de visualiza√ß√µes e estat√≠sticas
6. **An√°lise de correla√ß√µes** entre alimenta√ß√£o, regi√£o e sa√∫de

## T√©cnica Proposta

Utilizaremos t√©cnicas de **ci√™ncia de dados explorat√≥ria** com foco em:

- Manipula√ß√£o de dados com `tidyverse`
- Visualiza√ß√µes informativas com `ggplot2`
- Estat√≠sticas descritivas e inferenciais
- An√°lise de padr√µes regionais e socioecon√¥micos

Esta abordagem permitir√° identificar padr√µes n√£o evidentes nos dados brutos e gerar insights acion√°veis.

---

# Pacotes Requeridos

```{r pacotes}
# Manipula√ß√£o de dados
library(tidyverse)    # Conjunto de pacotes para ci√™ncia de dados (dplyr, ggplot2, etc)
library(data.table)   # Leitura eficiente de arquivos grandes

# Limpeza e transforma√ß√£o
library(janitor)      # Limpeza de nomes de colunas e dados
library(lubridate)    # Manipula√ß√£o de datas

# Visualiza√ß√£o
library(ggplot2)      # Gr√°ficos avan√ßados
library(scales)       # Formata√ß√£o de escalas em gr√°ficos
library(patchwork)    # Combina√ß√£o de m√∫ltiplos gr√°ficos
library(viridis)      # Paletas de cores acess√≠veis

# Tabelas e resumos
library(knitr)        # Tabelas formatadas
library(kableExtra)   # Tabelas HTML estilizadas
library(summarytools) # Estat√≠sticas descritivas

# An√°lise
library(corrplot)     # Matrizes de correla√ß√£o
library(skimr)        # Resumo r√°pido de dados
```
---

# Prepara√ß√£o dos Dados

## Fonte dos Dados

**Fonte Original:** [ENANI 2019 - Kaggle](https://www.kaggle.com/datasets/marcelosilva2604/enani-2019) [@kaggle_enani]

**Descri√ß√£o da Fonte:**

O **ENANI 2019** (Estudo Nacional de Alimenta√ß√£o e Nutri√ß√£o Infantil) [@enani2019] foi conduzido pelo Minist√©rio da Sa√∫de do Brasil em parceria com universidades brasileiras. O estudo teve como objetivo:

- **Prop√≥sito**: Avaliar o estado nutricional e os padr√µes alimentares de crian√ßas brasileiras menores de 5 anos
- **Per√≠odo de coleta**: 2019
- **Amostra**: Aproximadamente 14.559 crian√ßas de todas as regi√µes do Brasil
- **Vari√°veis originais**: 741 vari√°veis cobrindo dados demogr√°ficos, socioecon√¥micos, alimentares, antropom√©tricos e de sa√∫de
- **Peculiaridades**: 
  - Dados anonimizados (IDs com sufixo "_anon")
  - Muitos valores ausentes (NA) devido √† natureza modular da pesquisa
  - M√∫ltiplos tipos de dados (num√©ricos, categ√≥ricos, datas)
  - Codifica√ß√£o espec√≠fica para respostas (ex: "Sim", "N√£o", c√≥digos num√©ricos)

```{r importacao}
# Caminho do arquivo
arquivo <- "data/data_bioq_calib_anon_1a.csv"

# Leitura do arquivo CSV (usando data.table para efici√™ncia)
dados_raw <- fread(arquivo, encoding = "UTF-8")
```

**Dimens√µes do Dataset Original:**

```{r dimensoes_originais}
tibble(
  M√©trica = c("N√∫mero de Linhas", "N√∫mero de Colunas"),
  Valor = c(nrow(dados_raw), ncol(dados_raw))
) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## Limpeza e Transforma√ß√£o dos Dados

### Etapa 1: Inspe√ß√£o Inicial e Sele√ß√£o de Vari√°veis

#### Dimens√µes do Dataset

```{r inspecao_inicial}
# An√°lise de valores ausentes
na_percent <- colSums(is.na(dados_raw)) / nrow(dados_raw) * 100
na_top20 <- head(sort(na_percent, decreasing = TRUE), 20)

# Criar tabela informativa
tibble(
  dimensao = c("Linhas (registros)", "Colunas (vari√°veis)"),
  valor = c(nrow(dados_raw), ncol(dados_raw))
) %>%
  kable(caption = "Dimens√µes do Dataset Bruto ENANI 2019") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

#### An√°lise de Valores Ausentes

```{r analise_nas}
# Top 20 colunas com mais NAs
tibble(
  variavel = names(na_top20),
  percentual_na = round(na_top20, 1)
) %>%
  kable(caption = "Top 20 Vari√°veis com Maior Percentual de NAs") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

**Justificativa da limpeza**: Com 741 vari√°veis, precisamos selecionar apenas as mais relevantes para an√°lise nutricional. Focaremos em:

- Vari√°veis demogr√°ficas e geogr√°ficas
- Dados da crian√ßa (idade, sexo)
- Padr√µes alimentares (aleitamento, consumo alimentar)
- Dados antropom√©tricos (peso, altura)
- Informa√ß√µes socioecon√¥micas

```{r selecao_variaveis}
# Sele√ß√£o de vari√°veis relevantes para an√°lise nutricional
dados_limpo <- dados_raw %>%
  select(
    # Identificadores
    id_anon, id_domic_anon,
    
    # Geografia
    a00_regiao, a11_situacao,
    
    # Dados da crian√ßa
    b02_sexo, b04_idade, b05a_idade_em_meses,
    
    # Alimenta√ß√£o infantil (primeiros 2 anos)
    e01_leite_peito, e02_agua, e11_suco, e12_fruta_inteira,
    e16_comida_sal, e21_arroz, e26_feijao, e27_carne,
    e31_salgadinhos, e33_refrigerante, e36_bala,
    
    # Dados de nascimento e sa√∫de
    h01_semanas_gravidez, h02_peso, h03_altura, h04_parto,
    h05_chupeta_usou,
    
    # Dados antropom√©tricos atuais (buscando padr√µes de coluna)
    matches("peso.*atual|altura.*atual|imc", ignore.case = TRUE)
  )
```

#### Resumo da Sele√ß√£o

```{r resumo_selecao}
tibble(
  metrica = c("Vari√°veis selecionadas", "Registros mantidos", "Taxa de redu√ß√£o"),
  valor = c(
    paste0(ncol(dados_limpo), " de ", ncol(dados_raw)),
    nrow(dados_limpo),
    paste0(round((1 - ncol(dados_limpo)/ncol(dados_raw)) * 100, 1), "%")
  )
) %>%
  kable(caption = "Resumo da Sele√ß√£o de Vari√°veis") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

### Etapa 2: Limpeza de Nomes de Colunas

```{r limpeza_nomes}
# Padroniza√ß√£o de nomes de colunas
dados_limpo <- dados_limpo %>%
  clean_names() %>%  # Remove caracteres especiais e padroniza
  rename(
    regiao = a00_regiao,
    situacao = a11_situacao,
    sexo = b02_sexo,
    idade_anos = b04_idade,
    idade_meses = b05a_idade_em_meses,
    leite_materno = e01_leite_peito,
    agua = e02_agua,
    suco = e11_suco,
    fruta = e12_fruta_inteira,
    comida_sal = e16_comida_sal,
    arroz = e21_arroz,
    feijao = e26_feijao,
    carne = e27_carne,
    salgadinho = e31_salgadinhos,
    refrigerante = e33_refrigerante,
    bala = e36_bala,
    semanas_gestacao = h01_semanas_gravidez,
    peso_nascer = h02_peso,
    altura_nascer = h03_altura,
    tipo_parto = h04_parto,
    usou_chupeta = h05_chupeta_usou
  )
```

#### Exemplo de Nomes Padronizados

```{r exemplo_nomes}
tibble(
  nome_padronizado = head(names(dados_limpo), 20)
) %>%
  kable(caption = "Primeiras 20 Vari√°veis com Nomes Padronizados") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

### Etapa 3: Tratamento de Valores Ausentes e Tipos de Dados

#### Convers√£o de Tipos

```{r tratamento_nas}
# Convers√£o de tipos de dados
dados_limpo <- dados_limpo %>%
  mutate(
    # Convers√£o de fatores
    regiao = as.factor(regiao),
    situacao = as.factor(situacao),
    sexo = as.factor(sexo),
    
    # Convers√£o de vari√°veis num√©ricas
    idade_anos = as.numeric(idade_anos),
    idade_meses = as.numeric(str_extract(idade_meses, "\\d+")), # O dado √© em formato de string (ex.: "22 meses"), extraimos apenas o n√∫mero
    peso_nascer = as.numeric(peso_nascer),
    altura_nascer = as.numeric(altura_nascer),
    semanas_gestacao = as.numeric(semanas_gestacao),
    
    # Convers√£o de vari√°veis bin√°rias (Sim/N√£o)
    across(c(leite_materno, agua, suco, fruta, comida_sal, 
             arroz, feijao, carne, salgadinho, refrigerante, bala),
           ~case_when(
             . == "Sim" ~ TRUE,
             . == "N√£o" ~ FALSE,
             TRUE ~ NA
           ))
  )
```

#### Verifica√ß√£o da Extra√ß√£o de Idade

```{r verificacao_idade}
# Exemplos de valores extra√≠dos
dados_limpo %>% 
  select(id_anon, idade_meses) %>% 
  head(10) %>%
  kable(caption = "Exemplos de Idade em Meses Extra√≠da") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

```{r resumo_idade}
# Estat√≠sticas descritivas
tibble(
  estatistica = c("M√≠nimo", "1¬∫ Quartil", "Mediana", "M√©dia", "3¬∫ Quartil", "M√°ximo", "NAs"),
  valor = c(
    min(dados_limpo$idade_meses, na.rm = TRUE),
    quantile(dados_limpo$idade_meses, 0.25, na.rm = TRUE),
    median(dados_limpo$idade_meses, na.rm = TRUE),
    round(mean(dados_limpo$idade_meses, na.rm = TRUE), 1),
    quantile(dados_limpo$idade_meses, 0.75, na.rm = TRUE),
    max(dados_limpo$idade_meses, na.rm = TRUE),
    sum(is.na(dados_limpo$idade_meses))
  )
) %>%
  kable(caption = "Estat√≠sticas Descritivas de Idade em Meses") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

#### Estat√≠sticas de Valores Ausentes

```{r estatisticas_nas}
na_summary <- dados_limpo %>%
  summarise(across(everything(), ~sum(is.na(.)))) %>%
  pivot_longer(everything(), names_to = "variavel", values_to = "n_nas") %>%
  mutate(perc_nas = round(n_nas / nrow(dados_limpo) * 100, 1)) %>%
  arrange(desc(perc_nas)) %>%
  filter(perc_nas > 10)

na_summary %>%
  kable(caption = "Vari√°veis com Mais de 10% de Valores Ausentes") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

**Decis√µes sobre NAs**: Manteremos os NAs por enquanto, pois muitas vari√°veis s√£o contextuais (ex: perguntas sobre alimenta√ß√£o aplicadas apenas a certas idades). An√°lises espec√≠ficas filtrar√£o conforme necess√°rio.

### Etapa 4: Cria√ß√£o de Novas Vari√°veis

```{r novas_variaveis}
# Cria√ß√£o de vari√°veis derivadas e categ√≥ricas
dados_limpo <- dados_limpo %>%
  mutate(
    # Faixa et√°ria
    faixa_etaria = case_when(
      idade_meses < 6 ~ "0-5 meses",
      idade_meses < 12 ~ "6-11 meses",
      idade_meses < 24 ~ "12-23 meses",
      idade_meses < 36 ~ "24-35 meses",
      idade_meses < 48 ~ "36-47 meses",
      TRUE ~ "48-59 meses"
    ) %>% factor(levels = c("0-5 meses", "6-11 meses", "12-23 meses", 
                             "24-35 meses", "36-47 meses", "48-59 meses")),
    
    # Classifica√ß√£o de peso ao nascer
    classificacao_peso_nascer = case_when(
      peso_nascer < 2500 ~ "Baixo peso",
      peso_nascer >= 2500 & peso_nascer < 4000 ~ "Adequado",
      peso_nascer >= 4000 ~ "Macrossomia",
      TRUE ~ "N√£o informado"
    ) %>% factor(levels = c("Baixo peso", "Adequado", "Macrossomia", "N√£o informado")),
    
    # Idade gestacional
    classificacao_gestacao = case_when(
      semanas_gestacao < 37 ~ "Prematuro",
      semanas_gestacao >= 37 & semanas_gestacao <= 42 ~ "A termo",
      semanas_gestacao > 42 ~ "P√≥s-termo",
      TRUE ~ "N√£o informado"
    ) %>% factor(levels = c("Prematuro", "A termo", "P√≥s-termo", "N√£o informado")),
    
    # √çndice de alimentos saud√°veis (soma de alimentos b√°sicos)
    alimentos_saudaveis = rowSums(select(., arroz, feijao, carne, fruta), na.rm = TRUE),
    
    # √çndice de alimentos ultraprocessados
    alimentos_ultraprocessados = rowSums(select(., salgadinho, refrigerante, bala), na.rm = TRUE),
    
    # Raz√£o saud√°vel/ultraprocessado
    razao_alimentar = ifelse(alimentos_ultraprocessados > 0,
                             alimentos_saudaveis / alimentos_ultraprocessados,
                             alimentos_saudaveis)
  )
```

#### Resumo das Vari√°veis Criadas

```{r resumo_novas_variaveis}
tibble(
  variavel = c("faixa_etaria", "classificacao_peso_nascer", "classificacao_gestacao",
               "alimentos_saudaveis", "alimentos_ultraprocessados", "razao_alimentar"),
  tipo = c("Categ√≥rica", "Categ√≥rica", "Categ√≥rica", "Num√©rica", "Num√©rica", "Num√©rica"),
  descricao = c(
    "6 faixas et√°rias (0-5, 6-11, 12-23, 24-35, 36-47, 48-59 meses)",
    "Baixo peso (<2500g), Adequado, Macrossomia (>4000g) [@oms2021]",
    "Prematuro (<37sem), A termo, P√≥s-termo (>42sem) [@oms2021]",
    "Soma de arroz + feij√£o + carne + fruta consumidos",
    "Soma de salgadinho + refrigerante + bala consumidos",
    "Raz√£o entre alimentos saud√°veis e ultraprocessados [@guia_alimentar2021]"
  )
) %>%
  kable(caption = "Vari√°veis Derivadas Criadas") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

### Etapa 5: Filtros e Dataset Final

```{r dataset_final}
# Filtrar apenas crian√ßas com dados m√≠nimos essenciais
dados_final <- dados_limpo %>%
  filter(
    !is.na(idade_meses),
    !is.na(sexo),
    !is.na(regiao)
  )
```

#### Resumo do Dataset Final

```{r resumo_final}
tibble(
  metrica = c("Registros ap√≥s filtros", "Vari√°veis finais", "Registros removidos"),
  valor = c(
    nrow(dados_final),
    ncol(dados_final),
    nrow(dados_limpo) - nrow(dados_final)
  )
) %>%
  kable(caption = "Resumo do Dataset Final") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

## Visualiza√ß√£o do Dataset Final

### Amostra dos Dados Limpos

```{r visualizacao_final}
# Amostra dos dados limpos
dados_final %>%
  select(id_anon, regiao, sexo, idade_meses, faixa_etaria,
         leite_materno, alimentos_saudaveis, alimentos_ultraprocessados) %>%
  head(20) %>%
  kable(caption = "Amostra do Dataset ENANI 2019 Limpo") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)
```

### Resumo Estat√≠stico Consolidado

#### Distribui√ß√µes Categ√≥ricas

```{r resumo_categoricas}
# Distribui√ß√£o por Regi√£o
regiao_dist <- dados_final %>%
  count(regiao, name = "frequencia") %>%
  mutate(percentual = round(frequencia / sum(frequencia) * 100, 1))

regiao_dist %>%
  kable(caption = "Distribui√ß√£o por Regi√£o") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

```{r resumo_sexo}
# Distribui√ß√£o por Sexo
sexo_dist <- dados_final %>%
  count(sexo, name = "frequencia") %>%
  mutate(percentual = round(frequencia / sum(frequencia) * 100, 1))

sexo_dist %>%
  kable(caption = "Distribui√ß√£o por Sexo") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

```{r resumo_faixa_etaria}
# Distribui√ß√£o por Faixa Et√°ria
faixa_dist <- dados_final %>%
  count(faixa_etaria, name = "frequencia") %>%
  mutate(percentual = round(frequencia / sum(frequencia) * 100, 1))

faixa_dist %>%
  kable(caption = "Distribui√ß√£o por Faixa Et√°ria") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

```{r resumo_situacao}
# Distribui√ß√£o por Situa√ß√£o
situacao_dist <- dados_final %>%
  count(situacao, name = "frequencia") %>%
  mutate(percentual = round(frequencia / sum(frequencia) * 100, 1))

situacao_dist %>%
  kable(caption = "Distribui√ß√£o Urbano vs Rural") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

#### Estat√≠sticas de Vari√°veis Num√©ricas

```{r resumo_numericas}
dados_final %>%
  select(idade_meses, peso_nascer, altura_nascer, semanas_gestacao,
         alimentos_saudaveis, alimentos_ultraprocessados) %>%
  summary() %>%
  kable(caption = "Resumo Estat√≠stico de Vari√°veis Num√©ricas") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

**Resumo consolidado**: O dataset final cont√©m aproximadamente 14.500 crian√ßas brasileiras com informa√ß√µes sobre alimenta√ß√£o, dados de nascimento e caracter√≠sticas demogr√°ficas. A maioria das vari√°veis alimentares apresenta NAs devido √† aplicabilidade contextual por idade.

---

# An√°lise Explorat√≥ria dos Dados

## Distribui√ß√£o Demogr√°fica e Geogr√°fica

### Distribui√ß√£o por Regi√£o e Situa√ß√£o

```{r distribuicao_geografica}
# Gr√°fico de distribui√ß√£o por regi√£o
p1 <- dados_final %>%
  count(regiao) %>%
  mutate(regiao = fct_reorder(regiao, n)) %>%
  ggplot(aes(x = regiao, y = n, fill = regiao)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = n), hjust = -0.2, size = 3.5) +
  coord_flip() +
  scale_fill_viridis_d(option = "D") +
  labs(
    title = "Distribui√ß√£o de Crian√ßas por Regi√£o do Brasil",
    subtitle = "ENANI 2019 - Amostra Nacional",
    x = NULL,
    y = "N√∫mero de Crian√ßas"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", size = 14))

# Gr√°fico de situa√ß√£o (Urbano/Rural)
p2 <- dados_final %>%
  count(situacao) %>%
  ggplot(aes(x = "", y = n, fill = situacao)) +
  geom_col(width = 1) +
  coord_polar(theta = "y") +
  geom_text(aes(label = paste0(round(n/sum(n)*100, 1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +
  scale_fill_manual(values = c("#2E7D32", "#FFB300")) +
  labs(
    title = "Distribui√ß√£o Urbano vs Rural",
    fill = "Situa√ß√£o"
  ) +
  theme_void() +
  theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5))

# Combinar gr√°ficos
p1 + p2 + plot_layout(widths = c(2, 1))
```

**Insight**: A distribui√ß√£o geogr√°fica mostra a representatividade da amostra em todas as regi√µes brasileiras, com predomin√¢ncia urbana refletindo a realidade demogr√°fica do pa√≠s. Os dados s√£o provenientes do ENANI 2019 [@enani2019], um estudo de base populacional representativo do Brasil.

**Contexto**: Este √© nosso **ponto de partida** ‚Äî uma amostra robusta e representativa que permite generaliza√ß√µes para todo o pa√≠s. A predomin√¢ncia urbana (>90%) reflete a realidade brasileira, mas tamb√©m alerta para a necessidade de aten√ß√£o especial √†s popula√ß√µes rurais (sub-representadas na amostra). H√° tamb√©m uma sub-representa√ß√£o nos dados de crian√ßas das regi√µes Sul, Norte e Nordeste se comparado com o Centro-Oeste e Sudeste.

### Distribui√ß√£o por Sexo e Faixa Et√°ria

```{r distribuicao_idade_sexo}
# Pir√¢mide et√°ria por sexo
dados_final %>%
  filter(!is.na(sexo), !is.na(faixa_etaria)) %>%
  count(sexo, faixa_etaria) %>%
  mutate(
    n = ifelse(sexo == "Masculino", -n, n),
    faixa_etaria = fct_rev(faixa_etaria)
  ) %>%
  ggplot(aes(x = faixa_etaria, y = n, fill = sexo)) +
  geom_col() +
  coord_flip() +
  scale_y_continuous(
    labels = function(x) abs(x),
    breaks = seq(-3000, 3000, 1000)
  ) +
  scale_fill_manual(values = c("Feminino" = "#E91E63", "Masculino" = "#2196F3")) +
  labs(
    title = "Pir√¢mide Et√°ria das Crian√ßas por Sexo",
    subtitle = "Distribui√ß√£o equilibrada entre os g√™neros",
    x = "Faixa Et√°ria",
    y = "N√∫mero de Crian√ßas",
    fill = "Sexo"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    legend.position = "bottom"
  )
```

**Insight**: A distribui√ß√£o por sexo √© praticamente equilibrada em todas as faixas et√°rias, indicando boa representatividade da amostra.

## An√°lise de Nascimento e Sa√∫de Perinatal

### Peso ao Nascer

```{r analise_peso_nascer}
# Distribui√ß√£o de peso ao nascer
p1 <- dados_final %>%
  filter(!is.na(peso_nascer), peso_nascer > 500, peso_nascer < 6000) %>%
  ggplot(aes(x = peso_nascer)) +
  geom_histogram(aes(y = after_stat(density)), bins = 50, fill = "#4CAF50", alpha = 0.7) +
  geom_density(color = "#1B5E20", linewidth = 1) +
  geom_vline(xintercept = 2500, linetype = "dashed", color = "red", linewidth = 1) +
  geom_vline(xintercept = 4000, linetype = "dashed", color = "orange", linewidth = 1) +
  annotate("text", x = 2500, y = 0.0012, label = "Baixo peso\n(<2500g)", 
           vjust = -0.5, color = "red", size = 3) +
  annotate("text", x = 4000, y = 0.0012, label = "Macrossomia\n(>4000g)", 
           vjust = -0.5, color = "orange", size = 3) +
  labs(
    title = "Distribui√ß√£o de Peso ao Nascer",
    x = "Peso ao Nascer (gramas)",
    y = "Densidade"
  ) +
  theme_minimal()

# Classifica√ß√£o de peso
p2 <- dados_final %>%
  filter(classificacao_peso_nascer != "N√£o informado") %>%
  count(classificacao_peso_nascer) %>%
  mutate(perc = n/sum(n)*100) %>%
  ggplot(aes(x = "", y = perc, fill = classificacao_peso_nascer)) +
  geom_col(width = 1) +
  coord_polar(theta = "y") +
  geom_text(aes(label = paste0(round(perc, 1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +
  scale_fill_manual(
    values = c("Baixo peso" = "#F44336", "Adequado" = "#4CAF50", "Macrossomia" = "#FF9800")
  ) +
  labs(
    title = "Classifica√ß√£o de Peso",
    fill = "Categoria"
  ) +
  theme_void() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5))

p1 + p2
```

**Insight**: Aproximadamente **85% das crian√ßas nascem saud√°veis**, demonstrando que o acompanhamento pr√©-natal brasileiro tem alcan√ßado resultados positivos. No entanto, os **10% com baixo peso** representam um grupo vulner√°vel que demanda aten√ß√£o especial desde o nascimento. Esta √© a nossa **linha de base** ‚Äî um bom ponto de partida que ser√° gradualmente comprometido pelos h√°bitos alimentares inadequados. As classifica√ß√µes seguem os crit√©rios estabelecidos pela OMS [@oms2021], onde peso inferior a 2500g √© considerado baixo peso e superior a 4000g caracteriza macrossomia.

### Idade Gestacional e Tipo de Parto

```{r analise_gestacao}
# Idade gestacional
p1 <- dados_final %>%
  filter(!is.na(semanas_gestacao), semanas_gestacao >= 20, semanas_gestacao <= 45) %>%
  ggplot(aes(x = semanas_gestacao)) +
  geom_histogram(bins = 30, fill = "#3F51B5", alpha = 0.7, color = "white") +
  geom_vline(xintercept = 37, linetype = "dashed", color = "red", linewidth = 1) +
  geom_vline(xintercept = 42, linetype = "dashed", color = "orange", linewidth = 1) +
  annotate("text", x = 34, y = 800, label = "Prematuro", color = "red", size = 3.5) +
  annotate("text", x = 39.5, y = 800, label = "A termo", color = "darkgreen", size = 3.5) +
  labs(
    title = "Distribui√ß√£o de Idade Gestacional",
    x = "Semanas de Gesta√ß√£o",
    y = "Frequ√™ncia"
  ) +
  theme_minimal()

# Tipo de parto por regi√£o
p2 <- dados_final %>%
  filter(!is.na(tipo_parto), !is.na(regiao)) %>%
  count(regiao, tipo_parto) %>%
  group_by(regiao) %>%
  mutate(perc = n/sum(n)*100) %>%
  ggplot(aes(x = regiao, y = perc, fill = tipo_parto)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = paste0(round(perc, 0), "%")), 
            position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Tipo de Parto por Regi√£o",
    x = "Regi√£o",
    y = "Percentual (%)",
    fill = "Tipo de Parto"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  )

p1 / p2
```

**Insight**: A preval√™ncia de cesarianas √© not√°vel em todas as regi√µes, reflexo da alta taxa brasileira de partos cir√∫rgicos. A classifica√ß√£o da idade gestacional segue os par√¢metros da OMS [@oms2021], com gesta√ß√µes inferiores a 37 semanas consideradas prematuras e superiores a 42 semanas classificadas como p√≥s-termo.

## An√°lise de Padr√µes Alimentares

### Aleitamento Materno

```{r analise_aleitamento}
# Aleitamento materno por faixa et√°ria
dados_final %>%
  filter(!is.na(leite_materno), !is.na(faixa_etaria)) %>%
  count(faixa_etaria, leite_materno) %>%
  group_by(faixa_etaria) %>%
  mutate(perc = n/sum(n)*100) %>%
  filter(leite_materno == TRUE) %>%
  ggplot(aes(x = faixa_etaria, y = perc, group = 1)) +
  geom_line(color = "#E91E63", linewidth = 1.5) +
  geom_point(color = "#E91E63", size = 4) +
  geom_text(aes(label = paste0(round(perc, 1), "%")), vjust = -1, size = 3.5) +
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, 20)) +
  labs(
    title = "Preval√™ncia de Aleitamento Materno por Faixa Et√°ria",
    subtitle = "Redu√ß√£o esperada com o aumento da idade",
    x = "Faixa Et√°ria",
    y = "Percentual com Aleitamento Materno (%)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

**Insight**: Este √© o **primeiro sinal de alerta**. A queda acentuada do aleitamento materno ap√≥s os 12 meses (de ~60% para ~20%) **abre as portas para alimentos inadequados**. Quanto mais cedo a crian√ßa abandona o leite materno, mais vulner√°vel ela fica √† introdu√ß√£o de ultraprocessados. Esta √© a **primeira ruptura** na trajet√≥ria nutricional saud√°vel [@oms2021]. A OMS recomenda aleitamento materno exclusivo at√© os 6 meses e continuado at√© os 2 anos ou mais [@oms2021].

**An√°lise Cr√≠tica**: 

### Consumo de Alimentos Saud√°veis vs Ultraprocessados

```{r analise_alimentos}
# Compara√ß√£o de consumo por faixa et√°ria
dados_final %>%
  filter(!is.na(faixa_etaria)) %>%
  group_by(faixa_etaria) %>%
  summarise(
    saudaveis = mean(alimentos_saudaveis, na.rm = TRUE),
    ultraprocessados = mean(alimentos_ultraprocessados, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c(saudaveis, ultraprocessados), 
               names_to = "tipo", values_to = "media") %>%
  ggplot(aes(x = faixa_etaria, y = media, fill = tipo)) +
  geom_col(position = "dodge") +
  scale_fill_manual(
    values = c("saudaveis" = "#4CAF50", "ultraprocessados" = "#F44336"),
    labels = c("Alimentos Saud√°veis", "Ultraprocessados")
  ) +
  labs(
    title = "M√©dia de Consumo: Alimentos Saud√°veis vs Ultraprocessados",
    subtitle = "Por faixa et√°ria",
    x = "Faixa Et√°ria",
    y = "M√©dia de Alimentos Consumidos",
    fill = "Tipo"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  )
```

**Insight**: Este √© o **achado mais preocupante** da an√°lise. Estamos testemunhando uma **transi√ß√£o nutricional negativa**: crian√ßas que come√ßam com aleitamento materno e alimenta√ß√£o complementar adequada **gradualmente substituem alimentos saud√°veis por ultraprocessados**. Esta √© uma **trajet√≥ria insustent√°vel** que est√° formando h√°bitos alimentares prejudiciais nos primeiros anos de vida ‚Äî exatamente quando o paladar e as prefer√™ncias se consolidam. **A janela cr√≠tica est√° entre 12-36 meses**, per√≠odo em que a deteriora√ß√£o alimentar √© mais acentuada. O consumo de ultraprocessados aumenta com a idade, indicando necessidade de interven√ß√µes educativas para fam√≠lias com crian√ßas maiores. O Guia Alimentar para Crian√ßas Brasileiras [@guia_alimentar2021] recomenda evitar alimentos ultraprocessados e priorizar alimentos in natura ou minimamente processados na alimenta√ß√£o infantil.

### Padr√µes Regionais de Alimenta√ß√£o

```{r analise_regional_alimentacao}
# Criar dataset para an√°lise regional
dados_regional <- dados_final %>%
  filter(!is.na(regiao)) %>%
  group_by(regiao) %>%
  summarise(
    n_total = n(),
    leite_materno_perc = mean(leite_materno, na.rm = TRUE) * 100,
    fruta_perc = mean(fruta, na.rm = TRUE) * 100,
    feijao_perc = mean(feijao, na.rm = TRUE) * 100,
    refrigerante_perc = mean(refrigerante, na.rm = TRUE) * 100,
    salgadinho_perc = mean(salgadinho, na.rm = TRUE) * 100
  )

# Heatmap de consumo por regi√£o
dados_regional %>%
  select(-n_total) %>%
  pivot_longer(-regiao, names_to = "alimento", values_to = "percentual") %>%
  mutate(
    alimento = case_when(
      alimento == "leite_materno_perc" ~ "Leite Materno",
      alimento == "fruta_perc" ~ "Frutas",
      alimento == "feijao_perc" ~ "Feij√£o",
      alimento == "refrigerante_perc" ~ "Refrigerante",
      alimento == "salgadinho_perc" ~ "Salgadinho"
    )
  ) %>%
  ggplot(aes(x = alimento, y = regiao, fill = percentual)) +
  geom_tile(color = "white", linewidth = 1) +
  geom_text(aes(label = paste0(round(percentual, 0), "%")), 
            color = "white", fontface = "bold", size = 4) +
  scale_fill_viridis_c(option = "plasma") +
  labs(
    title = "Padr√µes Alimentares por Regi√£o",
    subtitle = "Percentual de consumo de diferentes alimentos",
    x = NULL,
    y = NULL,
    fill = "Percentual (%)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "right"
  )
```
**Insight**: As **disparidades regionais** n√£o s√£o apenas geogr√°ficas ‚Äî s√£o reflexos de **desigualdades socioecon√¥micas e culturais**. Algumas regi√µes apresentam consumo de ultraprocessados at√© 30% maior que outras, indicando que pol√≠ticas p√∫blicas precisam ser **customizadas e contextualizadas**. Uma abordagem √∫nica para todo o Brasil n√£o ser√° efetiva. √â necess√°rio entender as realidades locais, os h√°bitos culturais e as condi√ß√µes socioecon√¥micas de cada regi√£o.

## An√°lise de Correla√ß√µes

```{r analise_correlacoes}
# Matriz de correla√ß√£o
dados_corr <- dados_final %>%
  select(
    idade_meses, peso_nascer, altura_nascer, semanas_gestacao,
    alimentos_saudaveis, alimentos_ultraprocessados, razao_alimentar
  ) %>%
  na.omit() %>%
  cor()

# Visualiza√ß√£o da matriz de correla√ß√£o
corrplot(dados_corr, 
         method = "color",
         type = "upper",
         addCoef.col = "black",
         tl.col = "black",
         tl.srt = 45,
         number.cex = 0.8,
         col = colorRampPalette(c("#F44336", "white", "#4CAF50"))(200),
         title = "Matriz de Correla√ß√£o entre Vari√°veis",
         mar = c(0,0,2,0))
```

**Insight**: As correla√ß√µes revelam rela√ß√µes esperadas (peso e altura ao nascer) e insights sobre a rela√ß√£o entre idade e padr√µes alimentares.

---

# Conclus√µes e Considera√ß√µes Finais

## S√≠ntese dos Achados

Esta an√°lise do ENANI 2019 revela uma **narrativa preocupante sobre a transi√ß√£o nutricional infantil no Brasil**: crian√ßas que nascem em condi√ß√µes adequadas, mas que progressivamente abandonam pr√°ticas alimentares saud√°veis em favor de alimentos ultraprocessados.

A maioria das crian√ßas brasileiras (aproximadamente 85%) nasce com peso adequado, demonstrando que o acompanhamento pr√©-natal tem alcan√ßado bons resultados. No entanto:

- **10% nascem com baixo peso** (<2500g), indicando vulnerabilidade nutricional desde o nascimento [@oms2021]
- Existe forte preval√™ncia de **cesarianas em todas as regi√µes**, um indicador de medicaliza√ß√£o excessiva do parto
- As disparidades regionais s√£o evidentes desde o nascimento

A an√°lise tamb√©m demonstra uma **queda acentuada e preocupante** do aleitamento materno:

- **Alta ades√£o nos primeiros meses** (0-5 meses): ~80% das crian√ßas recebem leite materno
- **Decl√≠nio progressivo**: J√° aos 12-23 meses, apenas ~40% mant√™m o aleitamento
- **Abandono prematuro**: Aos 24-35 meses, menos de 20% continuam sendo amamentadas

Esta trajet√≥ria contraria as recomenda√ß√µes da OMS [@oms2021], que preconiza aleitamento materno at√© os 2 anos ou mais. O abandono precoce do aleitamento abre espa√ßo para a entrada de alimentos inadequados.

O achado mais alarmante desta an√°lise √© a **rela√ß√£o inversamente proporcional entre idade e qualidade alimentar**:

Os dados mostram que:

- **Consumo de ultraprocessados aumenta progressivamente** com a idade
- **Alimentos saud√°veis s√£o gradualmente substitu√≠dos** por refrigerantes, salgadinhos e balas
- Existem **diferen√ßas regionais significativas**, com algumas regi√µes apresentando consumo ainda maior de ultraprocessados

Esta transi√ß√£o contraria todas as recomenda√ß√µes do Guia Alimentar para Crian√ßas Brasileiras [@guia_alimentar2021], que enfatiza alimentos in natura e minimamente processados.

## Recomenda√ß√µes

Com base nos achados, recomenda-se:

1. **Programas de incentivo ao aleitamento prolongado**
   - Licen√ßa-maternidade estendida
   - Apoio em creches e locais de trabalho
   - Campanhas educativas direcionadas a fam√≠lias com crian√ßas de 12-24 meses

2. **Regula√ß√£o de marketing de ultraprocessados**
   - Proibi√ß√£o de publicidade infantil de alimentos n√£o saud√°veis
   - Rotulagem frontal clara e compreens√≠vel
   - Restri√ß√µes em ambientes escolares

3. **Educa√ß√£o nutricional integrada**
   - Capacita√ß√£o de profissionais de sa√∫de da aten√ß√£o prim√°ria
   - Programas educativos para fam√≠lias sobre alimenta√ß√£o complementar
   - Integra√ß√£o com programas como Bolsa Fam√≠lia

4. **Monitoramento cont√≠nuo e regionalizado**
   - Acompanhamento dos padr√µes alimentares por regi√£o
   - Interven√ß√µes customizadas para realidades locais
   - Avalia√ß√£o peri√≥dica do impacto das pol√≠ticas

## Reflex√£o Final

Os dados do ENANI 2019 [@enani2019] pintam um retrato do Brasil que equilibra esperan√ßa e preocupa√ß√£o:

A janela de oportunidade est√° nos primeiros 1000 dias de vida (0-3 anos). √â neste per√≠odo que os h√°bitos alimentares se formam e que as interven√ß√µes t√™m maior impacto.

A mensagem final √© clara: Sem a√ß√µes efetivas e coordenadas, estamos formando uma gera√ß√£o de crian√ßas com h√°bitos alimentares inadequados, com consequ√™ncias para a sa√∫de p√∫blica nas pr√≥ximas d√©cadas (obesidade, diabetes, doen√ßas cardiovasculares).

---

# Refer√™ncias

<div id="refs"></div>

---

<div style="text-align: center; padding: 20px; background-color: #f5f5f5; border-radius: 10px; margin-top: 30px;">
  <h3>üìä Projeto desenvolvido para a disciplina de Computa√ß√£o para An√°lise de Dados</h3>
  <p><strong>Steffano Pereira</strong> | Novembro 2025</p>
  <p style="color: #666;">An√°lise realizada com R, tidyverse e ggplot2</p>
</div>
